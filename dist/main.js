(()=>{"use strict";var e=function(e,t,n,a){var i=document.createElement(e);if(t)for(var o in t)i[o]=t[o];return n&&(a&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i)),i},t=window.qTranslateConfig,n=function(e){var n="(\x3c!--:lang--\x3e|\x3c!--:--\x3e|\\[:lang]|\\[:]|{:lang}|{:})".replace(/lang/g,t.lang_code_format),a=new RegExp(n,"gi");if(3==="a~b".split(/(~)/).length)return e.split(a);for(var i,o=0,r=[];null!=(i=a.exec(e));)r.push(e.slice(o,i.index)),i.length>1&&r.push(i[1]),o=a.lastIndex;return o<e.length&&r.push(e.slice(o)),o===e.length&&r.push(""),r},a=function(e){var t=n(e);return i(t)},i=function(e){var n=new Object;for(var a in t.language_config)n[a]="";if(!e||!e.length)return n;if(1===e.length){var i=e[0];for(var o in t.language_config)n[o]+=i;return n}for(var r,s=new RegExp("\x3c!--:(lang)--\x3e".replace(/lang/g,t.lang_code_format),"gi"),l=new RegExp("\\[:(lang)]".replace(/lang/g,t.lang_code_format),"gi"),c=new RegExp("{:(lang)}".replace(/lang/g,t.lang_code_format),"gi"),d=!1,u=0;u<e.length;++u){var g=e[u];if(g.length)if(r=s.exec(g),s.lastIndex=0,null==r)if(r=l.exec(g),l.lastIndex=0,null==r)if(r=c.exec(g),c.lastIndex=0,null==r)if("\x3c!--:--\x3e"!==g&&"[:]"!==g&&"{:}"!==g)if(d)n[d]?n[d]+=g:n[d]=g,d=!1;else for(var f in n)n[f]+=g;else d=!1;else d=r[1];else d=r[1];else d=r[1]}return n},o="qtranslate-xt-admin-edit-language",r=function(e){try{sessionStorage.setItem(o,e)}catch(e){console.log('Failed to store "'+o+'" with sessionStorage',e)}},s=jQuery,l=window.qTranslateConfig,c=function(t){var c=this;this.getLanguages=function(){return l.language_config},this.getFlagLocation=function(){return l.flag_location},this.isLanguageEnabled=function(e){return!!l.language_config[e]},l.LSB?(l.activeLanguage=sessionStorage.getItem(o),l.activeLanguage&&this.isLanguageEnabled(l.activeLanguage)||(l.activeLanguage=l.language,this.isLanguageEnabled(l.activeLanguage)?r(l.activeLanguage):l.LSB=!1)):(l.activeLanguage=l.language,r(l.activeLanguage)),this.getActiveLanguage=function(){return l.activeLanguage};var d={};this.hasContentHook=function(e){return d[e]},this.addContentHook=function(t,n,i){if(!t)return!1;switch(t.tagName){case"TEXTAREA":break;case"INPUT":switch(t.type){case"button":case"checkbox":case"password":case"radio":case"submit":return!1}break;default:return!1}if(!i){if(!t.name)return!1;i=t.name}if(t.id){if(d[t.id]){if(s.contains(document,t))return d[t.id];c.removeContentHook(t)}}else if(d[i]){var o=0;do{++o,t.id=i+o}while(d[t.id])}else t.id=i;t.className+=" qtranxs-translatable";var r,u,g,f=d[t.id]={};if(f.name=i,f.contentField=t,f.lang=l.activeLanguage,n)switch(n){case"slug":r="qtranslate-slugs[";break;case"term":r="qtranslate-terms[";break;default:r="qtranslate-fields["}else n="[",r="qtranslate-fields[";f.encode=n;var h,v=f.name.indexOf("[");if(v<0)u=r+f.name+"]";else if(u=r+f.name.substring(0,v)+"]",f.name.lastIndexOf("[]")<0)u+=f.name.substring(v);else{var m=f.name.length-2;m>v&&(u+=f.name.substring(v,m)),g="[]"}if(f.fields={},!l.RAW){for(var p in h=a(t.value),t.value=h[f.lang],h){var y=h[p],w=u+"["+p+"]";g&&(w+=g);var b=e("input",{name:w,type:"hidden",className:"hidden",value:y});f.fields[p]=b,t.parentNode.insertBefore(b,t)}var C=s(t).closest("form");C.length?C.find('input[name="qtranslate-edit-language"]').length||e("input",{type:"hidden",name:"qtranslate-edit-language",value:l.activeLanguage},C[0],!0):console.error("No form found for translatable field id=",t.id)}switch(n){case"slug":case"term":l.RAW&&(h=a(t.value)),f.sepfield=e("input",{name:u+"[qtranslate-original-value]",type:"hidden",className:"hidden",value:h[l.default_language]});break;default:l.RAW||(f.sepfield=e("input",{name:u+"[qtranslate-separator]",type:"hidden",className:"hidden",value:n}))}return f.sepfield&&t.parentNode.insertBefore(f.sepfield,t),f},this.addContentHookC=function(e){return c.addContentHook(e,"[")},this.addContentHookB=function(e){return c.addContentHook(e,"[")},this.addContentHookById=function(e,t,n){return c.addContentHook(document.getElementById(e),t,n)},this.addContentHookByIdName=function(e){var t;switch(e[0]){case"<":case"[":t=e.substring(0,1),e=e.substring(1)}return c.addContentHookById(e,t)},this.addContentHookByIdC=function(e){return c.addContentHookById(e,"[")},this.addContentHookByIdB=function(e){return c.addContentHookById(e,"[")},this.addContentHooks=function(e,t,n){for(var a=0;a<e.length;++a){var i=e[a];c.addContentHook(i,t,n)}},this.addContentHooksByClass=function(e,t){var n;0!==e.indexOf("<")&&0!==e.indexOf("[")||(n=e.substring(0,1),e=e.substring(1)),function(e,t,n){t||(t=document);var a=t.getElementsByClassName(e);c.addContentHooks(a,n)}(e,t,n)},this.addContentHooksByTagInClass=function(e,t,n){for(var a=n.getElementsByClassName(e),i=0;i<a.length;++i){var o=a[i].getElementsByTagName(t);c.addContentHooks(o)}};var u=function(e){if(!e)return!1;e.sepfield&&s(e.sepfield).remove();var t={};for(var n in e.fields){var a=e.fields[n];t[n]=a.value,s(a).remove()}return s(e.contentField).removeClass("qtranxs-translatable"),delete d[e.contentField.id],t};this.removeContentHook=function(e){if(!e||!e.id||!d[e.id])return!1;var t=d[e.id];return u(t),s(e).removeClass("qtranxs-translatable"),!0},this.refreshContentHook=function(e){if(!e||!e.id)return!1;var t=d[e.id];return t&&u(t),c.addContentHook(e)};var g=function(e){if(e[l.language])return"("+l.language+") "+e[l.language];if(e[l.default_language])return"("+l.default_language+") "+e[l.default_language];for(var t in e)if(e[t])return"("+t+") "+e[t];return""},f=function(e){var t=null;for(var n in e)e[n]||(t||(t=g(e)),e[n]=t)},h=[],v=function(e){if(!e.nodeValue)return 0;var t=n(e.nodeValue);if(!t||!t.length||1===t.length)return 0;var a={};return a.nd=e,a.contents=i(t),f(a.contents),e.nodeValue=a.contents[l.activeLanguage],h.push(a),1},m=[],p=function(e,t){if(!e.hasAttribute(t))return 0;var a=e.getAttribute(t),o=n(a);if(!o||!o.length||1===o.length)return 0;var r={};return r.nd=e,r.attr=t,r.contents=i(o),f(r.contents),e.setAttribute(t,r.contents[l.activeLanguage]),m.push(r),1};this.addDisplayHook=function(e){if(!e||!e.tagName)return 0;switch(e.tagName){case"TEXTAREA":return 0;case"INPUT":return"submit"===e.type&&e.value?p(e,"value"):0}var t=0;if(e.childNodes&&e.childNodes.length)for(var n=0;n<e.childNodes.length;++n){var a=e.childNodes[n];switch(a.nodeType){case 1:t+=c.addDisplayHook(a);break;case 2:case 3:t+=v(a)}}return t},this.addDisplayHookById=function(e){return c.addDisplayHook(document.getElementById(e))};var y=function(e){var t=e.contentField.value;e.wpautop&&window.switchEditors&&(t=window.switchEditors.wpautop(t)),e.mce.setContent(t,{format:"html"})};this.addDisplayHooks=function(e){for(var t=0;t<e.length;++t){var n=e[t];c.addDisplayHook(n)}},this.addDisplayHookAttrs=function(e,t){for(var n=0;n<t.length;++n){var a=t[n];p(e,a)}},this.addDisplayHooksAttrs=function(e,t){for(var n=0;n<e.length;++n){var a=e[n];c.addDisplayHookAttrs(a,t)}},this.addDisplayHooksByClass=function(e,t){var n=t.getElementsByClassName(e);c.addDisplayHooks(n)},this.addDisplayHooksByTagInClass=function(e,t,n){for(var a=n.getElementsByClassName(e),i=0;i<a.length;++i){var o=a[i].getElementsByTagName(t);c.addDisplayHooks(o)}},this.addCustomContentHooks=function(){for(var e=0;e<l.custom_fields.length;++e){var t=l.custom_fields[e];c.addContentHookByIdName(t)}for(var n=0;n<l.custom_field_classes.length;++n){var a=l.custom_field_classes[n];c.addContentHooksByClass(a)}l.LSB&&c.addContentHooksTinyMCE()};var w=function(e){if(e.id){var t=d[e.id];if(t&&!t.mce){t.mce=e,e.getContainer().className+=" qtranxs-translatable",e.getElement().className+=" qtranxs-translatable";var n=t.updateTinyMCEonInit;return null==n&&(n=e.getContent({format:"html"}).replace(/\s+/g,"")!==t.contentField.value.replace(/\s+/g,"")),n&&y(t),t}}};this.addContentHooksTinyMCE=function(){if(window.tinyMCEPreInit&&window.tinyMCE)for(var e in d){var t=d[e];if("TEXTAREA"===t.contentField.tagName&&!t.mce&&!t.mceInit&&tinyMCEPreInit.mceInit[e]){if(t.mceInit=tinyMCEPreInit.mceInit[e],t.mceInit.wpautop){t.wpautop=t.mceInit.wpautop;var n=tinymce.DOM.select("#wp-"+e+"-wrap");n&&n.length&&(t.wrapper=n[0],t.wrapper&&(tinymce.DOM.hasClass(t.wrapper,"tmce-active")&&(t.updateTinyMCEonInit=!0),tinymce.DOM.hasClass(t.wrapper,"html-active")&&(t.updateTinyMCEonInit=!1)))}else t.updateTinyMCEonInit=!1;tinyMCEPreInit.mceInit[e].init_instance_callback=function(e){w(e)}}}},this.loadAdditionalTinyMceHooks=function(){window.tinyMCE&&tinyMCE.get().forEach((function(e){w(e)}))},l.onTabSwitchFunctions||(l.onTabSwitchFunctions=[]),l.onTabSwitchFunctionsSave||(l.onTabSwitchFunctionsSave=[]),l.onTabSwitchFunctionsLoad||(l.onTabSwitchFunctionsLoad=[]),this.addLanguageSwitchListener=function(e){l.onTabSwitchFunctions.push(e)},this.addLanguageSwitchBeforeListener=function(e){l.onTabSwitchFunctionsSave.push(e)},this.delLanguageSwitchBeforeListener=function(e){for(var t=0;t<l.onTabSwitchFunctionsSave.length;++t)if(l.onTabSwitchFunctionsSave[t]===e)return void l.onTabSwitchFunctionsSave.splice(t,1)},this.addLanguageSwitchAfterListener=function(e){l.onTabSwitchFunctionsLoad.push(e)},this.delLanguageSwitchAfterListener=function(e){for(var t=0;t<l.onTabSwitchFunctionsLoad.length;++t)if(l.onTabSwitchFunctionsLoad[t]===e)return void l.onTabSwitchFunctionsLoad.splice(t,1)},this.enableLanguageSwitchingButtons=function(e){var t=e?"block":"none";for(var n in l.tabSwitches){for(var a=l.tabSwitches[n],i=0;i<a.length;++i){a[i].parentElement.style.display=t;break}break}};var b=function(){for(var e=document.getElementsByClassName("wrap"),t=0;t<e.length;++t){var n=e[t].getElementsByTagName("form");if(n.length)return n[0]}var a=document.getElementsByTagName("form");if(1===a.length)return a[0];for(var i=0;i<a.length;++i){var o=a[i];if(o.getElementsByClassName("wrap").length)return o}return null};if("function"==typeof t.addContentHooks&&t.addContentHooks(this),l.page_config&&l.page_config.forms&&function(e){for(var t in e){var n=e[t],a=void 0;if(n.form){if(n.form.id)a=document.getElementById(n.form.id);else if(n.form.jquery)a=s(n.form.jquery);else if(n.form.name){var i=document.getElementsByName(n.form.name);i&&i.length&&(a=i[0])}}else a=document.getElementById(t);for(var o in a||(a=b())||(a=document),n.fields){var r=n.fields[o],l=[];if(r.container_id){var d=document.getElementById(r.container_id);d&&l.push(d)}else r.container_jquery?l=s(r.container_jquery):r.container_class?l=document.getElementsByClassName(r.container_class):l.push(a);var u=r.encode;switch(u){case"none":break;case"display":if(r.jquery)for(var g=0;g<l.length;++g){var f=l[g],h=s(f).find(r.jquery);r.attrs?c.addDisplayHooksAttrs(h,r.attrs):c.addDisplayHooks(h)}else{var v=r.id?r.id:o,m=document.getElementById(v);r.attrs?c.addDisplayHookAttrs(m,r.attrs):c.addDisplayHook(m)}break;case"[":case"<":case"{":case"byline":default:if(r.jquery)for(var p=0;p<l.length;++p){var y=l[p],w=s(y).find(r.jquery);c.addContentHooks(w,u,r.name)}else{var C=r.id?r.id:o;c.addContentHookById(C,u,r.name)}}}}}(l.page_config.forms),s(".i18n-multilingual").each((function(e,t){c.addContentHook(t,"[")})),s(".i18n-multilingual-curly").each((function(e,t){c.addContentHook(t,"{")})),s(".i18n-multilingual-term").each((function(e,t){c.addContentHook(t,"term")})),s(".i18n-multilingual-slug").each((function(e,t){c.addContentHook(t,"slug")})),s(".i18n-multilingual-display").each((function(e,t){c.addDisplayHook(t)})),(h.length||m.length||Object.keys(d).length)&&(this.onLoadLanguage=function(e,t){for(var n=l.onTabSwitchFunctionsLoad,a=0;a<n.length;++a)n[a].call(l.qtx,e,t)},this.switchActiveLanguage=function(e){if(l.activeLanguage!==e){if(l.activeLanguage){for(var t=!0,n=l.onTabSwitchFunctionsSave,a=0;a<n.length;++a)!1===n[a].call(l.qtx,l.activeLanguage,e)&&(t=!1);if(!t)return;for(var i=l.tabSwitches[l.activeLanguage],o=0;o<i.length;++o)i[o].classList.remove(l.lsb_style_active_class),s(i[o]).find(".button").removeClass("active")}var r=l.activeLanguage;l.activeLanguage=e,s('input[name="qtranslate-edit-language"]').val(e);for(var d=l.tabSwitches[l.activeLanguage],u=0;u<d.length;++u)d[u].classList.add(l.lsb_style_active_class),s(d[u]).find(".button").addClass("active");for(var g=l.onTabSwitchFunctions,f=0;f<g.length;++f)g[f].call(l.qtx,e,r);c.onLoadLanguage(e,r)}},this.clickSwitchLanguage=function(){var e=s(this).hasClass("button")?this.parentNode:this,t=e.lang;t?s(".qtranxs-lang-switch-wrap").hasClass("copying")?(c.copyContentFrom(t),s(e).find(".button").blur(),s(".qtranxs-lang-switch-wrap").removeClass("copying"),s(".qtranxs-lang-copy .button").removeClass("active")):c.switchActiveLanguage(t):alert("qTranslate-XT: This should not have happened: Please, report this incident to the developers: !lang")},this.toggleCopyFrom=function(){s(".qtranxs-lang-switch-wrap").toggleClass("copying"),s(".qtranxs-lang-copy .button").toggleClass("active"),s(".qtranxs-lang-switch-wrap").hasClass("copying")?s(".qtranxs-lang-switch").each((function(){s(this).attr("orig-title",s(this).attr("title")),s(this).attr("lang")===l.activeLanguage?s(this).attr("title",l.strings.CopyFromAlt):s(this).attr("title",l.strings.CopyFrom+" [:"+s(this).attr("lang")+"]")})):s(".qtranxs-lang-switch").each((function(){s(this).attr("title",s(this).attr("orig-title"))}))},this.copyContentFrom=function(e){var t=l.activeLanguage,n=!1;for(var a in d){var i=d[a],o=i.mce&&!i.mce.hidden,r=o?i.mce.getContent({format:"html"}):i.contentField.value;r||(r=i.fields[e].value)&&(i.contentField.value=r,o&&y(i),n=!0)}n&&c.onLoadLanguage(t,e)},this.createSetOfLSBwith=function(t){var n=e("ul",{className:"qtranxs-lang-switch-wrap "+t}),a=l.language_config;for(var i in l.tabSwitches||(l.tabSwitches={}),a){var o=a[i],r=l.flag_location,d=l.strings.ShowIn+o.admin_name+" [:"+i+"]",u=e("li",{lang:i,className:"qtranxs-lang-switch qtranxs-lang-switch-"+i,title:d,onclick:c.clickSwitchLanguage},n),g=u;"button"===l.lsb_style_subitem&&(g=e("button",{className:"button button-secondary",type:"button"},u)),e("img",{src:r+o.flag},g),e("span",{innerHTML:o.name},g),l.activeLanguage===i&&(u.classList.add(l.lsb_style_active_class),s(u).find(".button").addClass("active")),l.tabSwitches[i]||(l.tabSwitches[i]=[]),l.tabSwitches[i].push(u)}if(!l.hide_lsb_copy_content){var f=e("li",{className:"qtranxs-lang-copy"},n),h=e("button",{className:"button button-secondary",type:"button",title:l.strings.CopyFromAlt,onclick:c.toggleCopyFrom},f);e("span",{innerHTML:l.strings.CopyFrom},h)}return n},this.createSetOfLSB=function(){return c.createSetOfLSBwith(l.lsb_style_wrap_class+" widefat")},l.LSB)){this.addContentHooksTinyMCE(),function(){var e=document.getElementById("qtranxs-meta-box-lsb");if(e){var t=e.getElementsByClassName("inside");if(t.length){e.className+=" closed",s(e).find(".hndle").remove();var n=document.createElement("span");e.insertBefore(n,t[0]),n.className="hndle ui-sortable-handle";var a=c.createSetOfLSBwith(l.lsb_style_wrap_class);n.appendChild(a),s("#qtranxs-meta-box-lsb .hndle").unbind("click.postboxes")}}}();var C=[];if(l.page_config&&l.page_config.anchors)for(var L in l.page_config.anchors){var k=l.page_config.anchors[L],S=document.getElementById(L);if(S)C.push({target:S,where:k.where});else if(k.jquery)for(var _=s(k.jquery),x=0;x<_.length;++x){var B=_[x];C.push({target:B,where:k.where})}}if(!C.length){var H=t.langSwitchWrapAnchor;H||(H=b()),H&&C.push({target:H,where:"before"})}for(var E=0;E<C.length;++E){var T=C[E];if(!T.where||T.where.indexOf("before")>=0){var q=c.createSetOfLSB();T.target.parentNode.insertBefore(q,T.target)}if(T.where&&T.where.indexOf("after")>=0){var N=c.createSetOfLSB();T.target.parentNode.insertBefore(N,T.target.nextSibling)}if(T.where&&T.where.indexOf("first")>=0){var I=c.createSetOfLSB();T.target.insertBefore(I,T.target.firstChild)}if(T.where&&T.where.indexOf("last")>=0){var F=c.createSetOfLSB();T.target.insertBefore(F,null)}}this.addLanguageSwitchListener((function(e){r(e);for(var t=h.length;--t>=0;){var a=h[t];a.nd.parentNode?a.nd.nodeValue=a.contents[e]:h.splice(t,1)}for(var o=m.length;--o>=0;){var s=m[o];s.nd.parentNode?s.nd.setAttribute(s.attr,s.contents[e]):m.splice(o,1)}if(!l.RAW)for(var c in d){var u=d[c],g=u.mce&&!u.mce.hidden;g&&u.mce.save({format:"html"});var f=u.contentField.value.trim(),v=n(f);if(!v||v.length<=1){u.fields[u.lang].value=f,u.lang=e;var p=u.fields[u.lang].value;u.contentField.placeholder&&""!==p&&(u.contentField.placeholder=""),u.contentField.value=p,g&&y(u)}else{var w=i(v);for(var b in u.fields)u.fields[b].value=w[b];u.lang=e}}})),t.onTabSwitch&&this.addLanguageSwitchListener(t.onTabSwitch)}};l.js.get_qtx=function(){return l.qtx||(l.qtx=new c(l.js)),l.qtx},s(window).on("load",(function(){l.js.get_qtx().loadAdditionalTinyMceHooks()}))})();